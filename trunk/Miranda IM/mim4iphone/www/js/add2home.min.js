(function(){
var _1=navigator,_2=(/iphone|ipod|ipad/gi).test(_1.platform),_3=(/ipad/gi).test(_1.platform),_4="devicePixelRatio" in window&&window.devicePixelRatio>1,_5=_1.appVersion.match(/Safari/gi),_6="standalone" in _1&&_2,_7=_6&&_1.standalone,_8=_1.appVersion.match(/OS \d+_\d+/g),_9=_1.platform.split(" ")[0],_a=_1.language.replace("-","_"),_b=startX=0,_c=localStorage.getItem("_addToHome"),_d,_e,el,i,l,_12={animationIn:"drop",animationOut:"fade",startDelay:2000,lifespan:20000,bottomOffset:14,expire:0,message:"",touchIcon:false,arrow:true,iterations:100},_13={en_us:"Install this web app on your %device: tap `%icon` and then `<strong>Add to Home Screen</strong>`.",};
_8=_8?_8[0].replace(/[^\d_]/g,"").replace("_",".")*1:0;
_c=_c=="null"?0:_c*1;
if(window.addToHomeConfig){
for(i in window.addToHomeConfig){
_12[i]=window.addToHomeConfig[i];
}
}
if(!_12.expire||_c<new Date().getTime()){
_c=0;
}
if(_6&&!_c&&!_7&&_5){
document.addEventListener("DOMContentLoaded",ready,false);
window.addEventListener("load",loaded,false);
}
function ready(){
document.removeEventListener("DOMContentLoaded",ready,false);
var div=document.createElement("div"),_15,_16=_12.touchIcon?document.querySelectorAll("head link[rel=apple-touch-icon],head link[rel=apple-touch-icon-precomposed]"):[],_17,_18="";
div.id="addToHomeScreen";
div.style.cssText+="position:absolute;-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0;-webkit-transform:translate3d(0,0,0);";
div.style.left="-9999px";
if(_12.message in _13){
_a=_12.message;
_12.message="";
}
if(_12.message==""){
_12.message=_a in _13?_13[_a]:_13["en_us"];
}
if(_16.length){
for(i=0,l=_16.length;i<l;i++){
_17=_16[i].getAttribute("sizes");
if(_17){
if(_4&&_17=="114x114"){
_18=_16[i].href;
break;
}
}else{
_18=_16[i].href;
}
}
_18="<span style=\"background-image:url("+_18+")\" class=\"touchIcon\"></span>";
}
div.className=(_3?"ipad":"iphone")+(_18?" wide":"");
div.innerHTML=_18+_12.message.replace("%device",_9).replace("%icon",_8>=4.2?"<span class=\"share\"></span>":"<span class=\"plus\">+</span>")+(_12.arrow?"<span class=\"arrow\"></span>":"")+"<span class=\"close\">x</span>";
document.body.appendChild(div);
el=div;
_15=el.querySelector(".close");
if(_15){
_15.addEventListener("click",addToHomeClose,false);
}
if(_12.expire){
localStorage.setItem("_addToHome",new Date().getTime()+_12.expire*60*1000);
}
}
function loaded(){
window.removeEventListener("load",loaded,false);
setTimeout(function(){
var _19;
_b=_3?window.scrollY:window.innerHeight+window.scrollY;
startX=_3?window.scrollX:Math.round((window.innerWidth-el.offsetWidth)/2)+window.scrollX;
el.style.top=_3?_b+_12.bottomOffset+"px":_b-el.offsetHeight-_12.bottomOffset+"px";
el.style.left=_3?startX+208-Math.round(el.offsetWidth/2)+"px":startX+"px";
switch(_12.animationIn){
case "drop":
if(_3){
_19="0.6s";
el.style.webkitTransform="translate3d(0,"+-(window.scrollY+_12.bottomOffset+el.offsetHeight)+"px,0)";
}else{
_19="0.9s";
el.style.webkitTransform="translate3d(0,"+-(_b+_12.bottomOffset)+"px,0)";
}
break;
case "bubble":
if(_3){
_19="0.6s";
el.style.opacity="0";
el.style.webkitTransform="translate3d(0,"+(_b+50)+"px,0)";
}else{
_19="0.6s";
el.style.webkitTransform="translate3d(0,"+(el.offsetHeight+_12.bottomOffset+50)+"px,0)";
}
break;
default:
_19="1s";
el.style.opacity="0";
}
setTimeout(function(){
el.style.webkitTransitionDuration=_19;
el.style.opacity="1";
el.style.webkitTransform="translate3d(0,0,0)";
el.addEventListener("webkitTransitionEnd",transitionEnd,false);
},0);
_e=setTimeout(addToHomeClose,_12.lifespan);
},_12.startDelay);
}
function transitionEnd(){
el.removeEventListener("webkitTransitionEnd",transitionEnd,false);
el.style.webkitTransitionProperty="-webkit-transform";
el.style.webkitTransitionDuration="0.2s";
if(_e){
clearInterval(_d);
_d=setInterval(setPosition,_12.iterations);
}else{
el.parentNode.removeChild(el);
}
}
function setPosition(){
var _1a=new WebKitCSSMatrix(window.getComputedStyle(el,null).webkitTransform),_1b=_3?window.scrollY-_b:window.scrollY+window.innerHeight-_b,_1c=_3?window.scrollX-startX:window.scrollX+Math.round((window.innerWidth-el.offsetWidth)/2)-startX;
if(_1b==_1a.m42&&_1c==_1a.m41){
return;
}
clearInterval(_d);
el.removeEventListener("webkitTransitionEnd",transitionEnd,false);
setTimeout(function(){
el.addEventListener("webkitTransitionEnd",transitionEnd,false);
el.style.webkitTransform="translate3d("+_1c+"px,"+_1b+"px,0)";
},0);
}
function addToHomeClose(){
clearInterval(_d);
clearTimeout(_e);
_e=null;
el.removeEventListener("webkitTransitionEnd",transitionEnd,false);
var _1d=_3?window.scrollY-_b:window.scrollY+window.innerHeight-_b,_1e=_3?window.scrollX-startX:window.scrollX+Math.round((window.innerWidth-el.offsetWidth)/2)-startX,_1f="1",_20="0",_21=el.querySelector(".close");
if(_21){
_21.removeEventListener("click",addToHomeClose,false);
}
el.style.webkitTransitionProperty="-webkit-transform,opacity";
switch(_12.animationOut){
case "drop":
if(_3){
_20="0.4s";
_1f="0";
_1d=_1d+50;
}else{
_20="0.6s";
_1d=_1d+el.offsetHeight+_12.bottomOffset+50;
}
break;
case "bubble":
if(_3){
_20="0.8s";
_1d=_1d-el.offsetHeight-_12.bottomOffset-50;
}else{
_20="0.4s";
_1f="0";
_1d=_1d-50;
}
break;
default:
_20="0.8s";
_1f="0";
}
el.addEventListener("webkitTransitionEnd",transitionEnd,false);
el.style.opacity=_1f;
el.style.webkitTransitionDuration=_20;
el.style.webkitTransform="translate3d("+_1e+"px,"+_1d+"px,0)";
}
window.addToHomeClose=addToHomeClose;
})();

